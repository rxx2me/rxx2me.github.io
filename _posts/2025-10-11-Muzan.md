---
layout: post
title: "Cyberyard CTF - Muzan"
date: 2025-10-11 21:30 +0300
categories: [writeup]         
tags: [CTF, Reversing, Cyberyard]          
toc: true                 
pin: false                
description: "Do you think you’ve chased me down?"
---


## Cyberyard CTF - Muzan



### كود الحل : 
```bash
#!/usr/bin/env python3
Q=[0x2672F0BC4D4B105C,0x6066A4EC7505175F,0x3431FBEA2D544958,0x3931AFBF7651170D,0x6B30FCFC27034543]
U=[q>>32 for q in Q];L=[q&0xffffffff for q in Q]
D0_0=int.from_bytes(b"Flag","big")
hexs=set("0123456789abcdef")
ans=None;K=None;P=[]
for x in range(256):
  for y in range(256):
    D1_0=int.from_bytes(b"Y{"+bytes([x,y]),"big")
    Slo=L[0]^D1_0;Shi=U[0]^D0_0^D1_0
    b=bytearray();pairs=[]
    ok=True
    for i in range(5):
      D1=L[i]^Slo;D0=U[i]^D1^Shi
      b+=D0.to_bytes(4,"big")+D1.to_bytes(4,"big")
      pairs.append((D0,D1))
    try:s=b.decode("ascii")
    except:ok=False
    if ok and s.startswith("FlagY{") and s.endswith("}") and all(c in hexs for c in s[7:-1]):
      ans=s;K=(Slo,Shi);P=pairs;break
  if ans:break
print("[1] K_lo =",hex(K[0])," K_up =",hex(K[1]))
print("[2] flag =",ans)
for i,(D0,D1) in enumerate(P):
  Uc=D0^D1^K[1];Lc=D1^K[0];Qc=(Uc<<32)|Lc
  print(f"[3] Q[{i}] match:",Qc==Q[i])

